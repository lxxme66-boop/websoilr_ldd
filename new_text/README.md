# æ™ºèƒ½æ–‡æœ¬QAç”Ÿæˆç³»ç»Ÿ - æ•´åˆç‰ˆ

ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„æ™ºèƒ½æ–‡æœ¬é—®ç­”ç”Ÿæˆç³»ç»Ÿï¼Œæ•´åˆäº†æ–‡æœ¬å¬å›ã€æ•°æ®å¤„ç†ã€QAç”Ÿæˆã€è´¨é‡æ§åˆ¶ã€å¤šæ¨¡æ€å¤„ç†ã€æœ¬åœ°æ¨¡å‹æ”¯æŒå’Œæ•°æ®æ”¹å†™å¢å¼ºåŠŸèƒ½ï¼Œä¸“æ³¨äºåŠå¯¼ä½“ã€å…‰å­¦ç­‰ä¸“ä¸šé¢†åŸŸã€‚

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

### ğŸ“Š å®Œæ•´æ•°æ®æµæ°´çº¿
- **æ–‡æœ¬å¬å›**ï¼šä»PDFæ–‡æ¡£ä¸­æ™ºèƒ½æå–å’Œå¬å›ç›¸å…³æ–‡æœ¬å†…å®¹
- **æ•°æ®æ¸…ç†**ï¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å’ŒAIæŠ€æœ¯è¿›è¡Œæ•°æ®åå¤„ç†
- **QAç”Ÿæˆ**ï¼šåŸºäºä¸“ä¸šé¢†åŸŸçŸ¥è¯†ç”Ÿæˆé«˜è´¨é‡é—®ç­”å¯¹
- **è´¨é‡æ§åˆ¶**ï¼šå¤šç»´åº¦è´¨é‡æ£€æŸ¥å’Œè‡ªåŠ¨æ”¹è¿›
- **æ•°æ®æ”¹å†™å¢å¼º**ï¼šæ™ºèƒ½æ”¹å†™æå‡å†…å®¹è´¨é‡å’Œå¤šæ ·æ€§
- **æœ€ç»ˆæ•´ç†**ï¼šç”Ÿæˆå®Œæ•´çš„æŠ¥å‘Šå’Œç»Ÿè®¡ä¿¡æ¯

### ğŸ”¬ ä¸“ä¸šé¢†åŸŸæ”¯æŒ
- **åŠå¯¼ä½“ç‰©ç†**ï¼šIGZOã€TFTã€OLEDã€èƒ½å¸¦ç†è®ºç­‰
- **å…‰å­¦ä¸å…‰ç”µå­**ï¼šå…‰è°±åˆ†æã€å™¨ä»¶ç‰¹æ€§ã€å…‰å­å¸æ”¶ç­‰
- **ææ–™ç§‘å­¦**ï¼šææ–™ç‰¹æ€§ã€åˆ¶å¤‡å·¥è‰ºç­‰
- **36+ä¸“ä¸šPromptæ¨¡æ¿**ï¼šè¦†ç›–å„ç§ä¸“ä¸šåœºæ™¯
- **é¢†åŸŸç‰¹å®šè´¨é‡æ£€æŸ¥**ï¼šé’ˆå¯¹ä¸åŒé¢†åŸŸçš„ä¸“ä¸šå‡†ç¡®æ€§éªŒè¯

### ğŸ¤– å¤šæ¨¡å‹æ”¯æŒ
- **äº‘ç«¯APIæ¨¡å‹**ï¼šè±†åŒ…ã€Qwenã€GPTç­‰OpenAIå…¼å®¹æ¥å£
- **æœ¬åœ°æ¨¡å‹æ”¯æŒ**ï¼š
  - Ollamaé›†æˆï¼ˆllama2, codellama, mistral, qwenç­‰ï¼‰
  - vLLMé«˜æ€§èƒ½æ¨ç†æœåŠ¡
  - Transformersæœ¬åœ°åŠ è½½
- **æ™ºèƒ½æ¨¡å‹åˆ‡æ¢**ï¼šæ ¹æ®ä»»åŠ¡è‡ªåŠ¨é€‰æ‹©æœ€ä½³æ¨¡å‹
- **æ··åˆéƒ¨ç½²**ï¼šæ”¯æŒäº‘ç«¯å’Œæœ¬åœ°æ¨¡å‹æ··åˆä½¿ç”¨

### ğŸ“š å¤šæ¨¡æ€å¤„ç†
- **PDFæ–‡æ¡£å¤„ç†**ï¼šè‡ªåŠ¨æå–æ–‡æœ¬å’Œå›¾åƒï¼Œæ”¯æŒå¤æ‚å­¦æœ¯è®ºæ–‡
- **å›¾æ–‡ç»“åˆé—®ç­”**ï¼šåŸºäºå›¾ç‰‡å’Œæ–‡æœ¬å†…å®¹ç”Ÿæˆé«˜è´¨é‡é—®ç­”å¯¹
- **ä¸“ä¸šå›¾è¡¨åˆ†æ**ï¼šæ”¯æŒåŠå¯¼ä½“ã€å…‰å­¦ç­‰ä¸“ä¸šé¢†åŸŸçš„å›¾è¡¨åˆ†æ
- **å¤šæ ¼å¼æ”¯æŒ**ï¼šPNGã€JPGã€JPEGã€WebPç­‰å›¾åƒæ ¼å¼

### ğŸš€ é«˜æ€§èƒ½å¤„ç†
- **å¼‚æ­¥æ‰¹å¤„ç†**ï¼šæ”¯æŒå¤§è§„æ¨¡å¹¶å‘å¤„ç†
- **å¤šè¿›ç¨‹æ¶æ„**ï¼šå……åˆ†åˆ©ç”¨å¤šæ ¸CPUèµ„æº
- **å†…å­˜ä¼˜åŒ–**ï¼šæ™ºèƒ½å†…å­˜ç®¡ç†å’Œç¼“å­˜æœºåˆ¶
- **è‡ªé€‚åº”è°ƒåº¦**ï¼šæ ¹æ®ç³»ç»Ÿè´Ÿè½½åŠ¨æ€è°ƒæ•´å¤„ç†ç­–ç•¥

### ğŸ” å¢å¼ºè´¨é‡æ§åˆ¶
- **å¤šç»´åº¦æ£€æŸ¥**ï¼šæ¨ç†æœ‰æ•ˆæ€§ã€é—®é¢˜æ¸…æ™°åº¦ã€ç­”æ¡ˆæ­£ç¡®æ€§ã€å›¾ç‰‡ä¾èµ–æ€§
- **åŒé˜¶æ®µéªŒè¯**ï¼šåˆæ­¥ç­›é€‰ + æ·±åº¦è´¨é‡æ£€æŸ¥
- **è‡ªåŠ¨æ”¹è¿›**ï¼šåŸºäºè´¨é‡åé¦ˆè‡ªåŠ¨ä¼˜åŒ–ç”Ÿæˆç»“æœ
- **è´¨é‡æŠ¥å‘Š**ï¼šè¯¦ç»†çš„è´¨é‡åˆ†æå’Œç»Ÿè®¡æŠ¥å‘Š

### âœ¨ æ•°æ®æ”¹å†™å¢å¼º
- **æ™ºèƒ½æ”¹å†™**ï¼šä¿æŒæ ¸å¿ƒå†…å®¹ä¸å˜ï¼Œæå‡è¡¨è¾¾è´¨é‡
- **å¤šæ ·åŒ–ç”Ÿæˆ**ï¼šç”Ÿæˆä¸åŒé£æ ¼çš„é—®ç­”å¯¹
- **è´¨é‡æå‡**ï¼šè‡ªåŠ¨ä¼˜åŒ–é—®é¢˜å’Œç­”æ¡ˆçš„ä¸“ä¸šæ€§
- **æ‰¹é‡å¤„ç†**ï¼šé«˜æ•ˆå¤„ç†å¤§è§„æ¨¡æ•°æ®æ”¹å†™

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
new_text/
â”œâ”€â”€ README.md                           # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ requirements.txt                    # å®Œæ•´ä¾èµ–åŒ…åˆ—è¡¨
â”œâ”€â”€ config.json                         # ç»Ÿä¸€é…ç½®æ–‡ä»¶
â”œâ”€â”€ run_pipeline.py                     # ç»Ÿä¸€æµæ°´çº¿è„šæœ¬
â”œâ”€â”€ text_qa_generation.py               # ä¸»è¦QAç”Ÿæˆè„šæœ¬
â”œâ”€â”€ text_qa_generation_enhanced.py      # å¢å¼ºç‰ˆQAç”Ÿæˆè„šæœ¬
â”œâ”€â”€ text_main_batch_inference.py        # æ‰¹é‡æ¨ç†è„šæœ¬
â”œâ”€â”€ text_main_batch_inference_enhanced.py # å¢å¼ºæ‰¹é‡æ¨ç†è„šæœ¬
â”œâ”€â”€ clean_text_data.py                  # æ•°æ®æ¸…ç†è„šæœ¬
â”œâ”€â”€ clean_data.py                       # åŸºç¡€æ•°æ®æ¸…ç†
â”œâ”€â”€ argument_data.py                    # æ•°æ®å‚æ•°å¤„ç†
â”œâ”€â”€ batch_inference.py                  # æ‰¹é‡æ¨ç†å·¥å…·
â”‚
â”œâ”€â”€ TextQA/                            # QAå¤„ç†æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ dataargument.py                # æ•°æ®å¤„ç†å’ŒQAç”Ÿæˆ
â”‚   â””â”€â”€ enhanced_quality_checker.py     # å¢å¼ºè´¨é‡æ£€æŸ¥
â”‚
â”œâ”€â”€ TextGeneration/                    # æ–‡æœ¬ç”Ÿæˆæ¨¡å—
â”‚   â”œâ”€â”€ Datageneration.py             # æ•°æ®ç”Ÿæˆé€»è¾‘
â”‚   â””â”€â”€ prompts_conf.py                # 36+ä¸“ä¸šPrompté…ç½®
â”‚
â”œâ”€â”€ LocalModels/                       # æœ¬åœ°æ¨¡å‹æ”¯æŒ
â”‚   â””â”€â”€ ollama_client.py               # Ollamaå®¢æˆ·ç«¯
â”‚
â”œâ”€â”€ MultiModal/                        # å¤šæ¨¡æ€å¤„ç†
â”‚   â””â”€â”€ pdf_processor.py              # PDFå¤„ç†å™¨
â”‚
â”œâ”€â”€ model_rewrite/                     # æ•°æ®æ”¹å†™å¢å¼ºæ¨¡å—
â”‚   â”œâ”€â”€ data_generation.py            # æ•°æ®ç”Ÿæˆå’Œæ”¹å†™
â”‚   â”œâ”€â”€ data_label.py                 # æ•°æ®æ ‡æ³¨å’Œè´¨é‡æ£€æŸ¥
â”‚   â””â”€â”€ rewrite_templates.py          # æ”¹å†™æ¨¡æ¿
â”‚
â”œâ”€â”€ Doubao/                           # è±†åŒ…æ¨¡å‹é›†æˆ
â”œâ”€â”€ Qwen/                             # Qwenæ¨¡å‹é›†æˆ  
â”œâ”€â”€ WizardLM/                         # WizardLMæ¨¡å‹é›†æˆ
â”œâ”€â”€ Utilis/                           # å·¥å…·å‡½æ•°
â”‚
â”œâ”€â”€ data/                             # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ input/                        # è¾“å…¥æ•°æ®
â”‚   â”œâ”€â”€ output/                       # è¾“å‡ºæ•°æ®
â”‚   â”œâ”€â”€ pdfs/                         # PDFæ–‡ä»¶
â”‚   â”œâ”€â”€ retrieved/                    # å¬å›æ•°æ®
â”‚   â”œâ”€â”€ cleaned/                      # æ¸…ç†æ•°æ®
â”‚   â”œâ”€â”€ qa_results/                   # QAç»“æœ
â”‚   â”œâ”€â”€ quality_checked/              # è´¨é‡æ£€æŸ¥ç»“æœ
â”‚   â”œâ”€â”€ rewritten/                    # æ”¹å†™ç»“æœ
â”‚   â””â”€â”€ final_output/                 # æœ€ç»ˆè¾“å‡º
â”‚
â”œâ”€â”€ temp/                             # ä¸´æ—¶æ–‡ä»¶
â”œâ”€â”€ logs/                             # æ—¥å¿—æ–‡ä»¶
â””â”€â”€ __init__.py                       # PythonåŒ…åˆå§‹åŒ–
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå®‰è£…

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd new_text

# å®‰è£…åŸºç¡€ä¾èµ–
pip install -r requirements.txt

# å¯é€‰ï¼šå®‰è£…å¤šæ¨¡æ€æ”¯æŒ
pip install PyMuPDF Pillow opencv-python

# å¯é€‰ï¼šå®‰è£…æœ¬åœ°æ¨¡å‹æ”¯æŒ
pip install ollama transformers torch torchvision
```

### 2. é…ç½®è®¾ç½®

```bash
# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œè®¾ç½®APIå¯†é’¥å’Œæ¨¡å‹è·¯å¾„
nano config.json
```

**é‡è¦é…ç½®é¡¹**ï¼š
```json
{
  "api": {
    "ark_url": "http://your-api-endpoint/v1",
    "api_key": "your-api-key-here"
  },
  "models": {
    "qa_generator_model": {
      "path": "/path/to/your/model"
    }
  },
  "professional_domains": {
    "default_domain": "semiconductor"
  }
}
```

### 3. ä¸€é”®è¿è¡Œ

#### å®Œæ•´æµæ°´çº¿å¤„ç†
```bash
# å¤„ç†PDFæ–‡ä»¶å¤¹ï¼Œç”ŸæˆåŠå¯¼ä½“é¢†åŸŸQA
python run_pipeline.py \
    --mode full_pipeline \
    --input_path data/pdfs/semiconductor_papers \
    --domain semiconductor

# å¤„ç†å…‰å­¦é¢†åŸŸæ–‡æ¡£
python run_pipeline.py \
    --mode full_pipeline \
    --input_path data/pdfs/optics_papers \
    --domain optics \
    --quality_threshold 0.8
```

#### ä½¿ç”¨æœ¬åœ°æ¨¡å‹
```bash
# å¯åŠ¨OllamaæœåŠ¡
ollama serve

# ä½¿ç”¨æœ¬åœ°æ¨¡å‹è¿è¡Œ
python run_pipeline.py \
    --mode full_pipeline \
    --input_path data/pdfs \
    --domain semiconductor \
    --use_local_models \
    --enable_multimodal
```

#### æ•°æ®æ”¹å†™å¢å¼º
```bash
# å¯¹ç°æœ‰QAæ•°æ®è¿›è¡Œæ”¹å†™å¢å¼º
python model_rewrite/data_generation.py \
    --data-path data/qa_results/results_343.json \
    --output-path data/rewritten/enhanced_qa.json \
    --template-type professional
```

### 4. åˆ†æ­¥éª¤è¿è¡Œ

**æ­¥éª¤1ï¼šæ–‡æœ¬å¬å›**
```bash
python run_pipeline.py \
    --mode text_retrieval \
    --input_path data/pdfs \
    --domain semiconductor
```

**æ­¥éª¤2ï¼šæ•°æ®æ¸…ç†**
```bash
python run_pipeline.py \
    --mode data_cleaning \
    --input_path data/retrieved/total_response.pkl
```

**æ­¥éª¤3ï¼šQAç”Ÿæˆ**
```bash
python run_pipeline.py \
    --mode qa_generation \
    --input_path data/cleaned/total_response.json \
    --domain semiconductor
```

**æ­¥éª¤4ï¼šè´¨é‡æ§åˆ¶**
```bash
python run_pipeline.py \
    --mode quality_control \
    --input_path data/qa_results/results_343.json \
    --quality_threshold 0.7
```

**æ­¥éª¤5ï¼šæ•°æ®æ”¹å†™å¢å¼º**
```bash
python run_pipeline.py \
    --mode data_rewriting \
    --input_path data/quality_checked/final_qa.json \
    --rewrite_ratio 0.3
```

## âš™ï¸ é…ç½®è¯´æ˜

### åŸºç¡€é…ç½®
```json
{
  "system_info": {
    "name": "æ™ºèƒ½æ–‡æœ¬QAç”Ÿæˆç³»ç»Ÿ - æ•´åˆç‰ˆ",
    "version": "3.0.0",
    "features": [
      "æ–‡æœ¬å¬å›ä¸æ£€ç´¢",
      "å¤šæ¨¡æ€PDFå¤„ç†", 
      "æ™ºèƒ½QAç”Ÿæˆ",
      "å¢å¼ºè´¨é‡æ§åˆ¶",
      "æœ¬åœ°æ¨¡å‹æ”¯æŒ",
      "ä¸“ä¸šé¢†åŸŸå®šåˆ¶",
      "æ•°æ®æ”¹å†™å¢å¼º"
    ]
  }
}
```

### æ¨¡å‹é…ç½®
```json
{
  "models": {
    "local_models": {
      "ollama": {
        "enabled": true,
        "base_url": "http://localhost:11434",
        "model_name": "qwen:7b"
      },
      "vllm": {
        "enabled": false,
        "base_url": "http://localhost:8000",
        "model_name": "Qwen/Qwen2-7B-Instruct"
      }
    }
  }
}
```

### ä¸“ä¸šé¢†åŸŸé…ç½®
```json
{
  "professional_domains": {
    "semiconductor": {
      "keywords": ["IGZO", "TFT", "OLED", "åŠå¯¼ä½“"],
      "quality_criteria": "high",
      "specific_checks": ["technical_accuracy", "formula_validity"]
    },
    "optics": {
      "keywords": ["å…‰è°±", "å…‰å­¦", "æ¿€å…‰", "æŠ˜å°„"],
      "quality_criteria": "high",
      "specific_checks": ["wavelength_accuracy", "optical_principles"]
    }
  }
}
```

### æ•°æ®æ”¹å†™é…ç½®
```json
{
  "rewriting": {
    "enabled": true,
    "rewrite_ratio": 0.3,
    "quality_improvement": true,
    "professional_enhancement": true,
    "template_types": ["basic", "advanced", "professional"]
  }
}
```

## ğŸ“– è¯¦ç»†ä½¿ç”¨æŒ‡å—

### å¤šæ¨¡æ€å¤„ç†
ç³»ç»Ÿæ”¯æŒä»PDFæ–‡æ¡£ä¸­æå–æ–‡æœ¬å’Œå›¾åƒï¼Œå¹¶åŸºäºå›¾æ–‡å†…å®¹ç”Ÿæˆé—®ç­”å¯¹ï¼š

```bash
# å¯ç”¨å¤šæ¨¡æ€å¤„ç†
python run_pipeline.py \
    --mode full_pipeline \
    --input_path data/pdfs/research_papers \
    --enable_multimodal \
    --domain semiconductor
```

**å¤šæ¨¡æ€è¾“å‡ºç¤ºä¾‹**ï¼š
```json
{
  "question": "æ ¹æ®å›¾ä¸­çš„I-Vç‰¹æ€§æ›²çº¿ï¼Œåˆ¤æ–­è¯¥å™¨ä»¶çš„ç±»å‹",
  "answer": "æ ¹æ®æ›²çº¿çš„éçº¿æ€§ç‰¹å¾å’Œé˜ˆå€¼ç”µå‹ï¼Œè¿™æ˜¯ä¸€ä¸ªåœºæ•ˆåº”æ™¶ä½“ç®¡",
  "choices": ["äºŒæç®¡", "ä¸‰æç®¡", "åœºæ•ˆåº”ç®¡", "ç”µé˜»"],
  "reasoning": "ä»I-Væ›²çº¿å¯ä»¥çœ‹å‡ºæ˜æ˜¾çš„é˜ˆå€¼ç”µå‹ç‰¹å¾...",
  "image_path": "./data/images/iv_curve.png",
  "context": "è¯¥å›¾æ˜¾ç¤ºäº†åŠå¯¼ä½“å™¨ä»¶çš„ç”µæµ-ç”µå‹ç‰¹æ€§..."
}
```

### æœ¬åœ°æ¨¡å‹ä½¿ç”¨

#### Ollamaé›†æˆ
```bash
# 1. å®‰è£…å¹¶å¯åŠ¨Ollama
curl -fsSL https://ollama.ai/install.sh | sh
ollama serve

# 2. ä¸‹è½½æ¨¡å‹
ollama pull qwen:7b
ollama pull llama2

# 3. é…ç½®ä½¿ç”¨æœ¬åœ°æ¨¡å‹
python run_pipeline.py \
    --use_local_models \
    --input_path data/pdfs \
    --domain semiconductor
```

#### æ¨¡å‹é€‰æ‹©ä¼˜å…ˆçº§
ç³»ç»Ÿæ”¯æŒæ™ºèƒ½æ¨¡å‹é€‰æ‹©ï¼Œä¼˜å…ˆçº§é¡ºåºï¼š
1. Ollamaï¼ˆå¦‚æœå¯ç”¨ä¸”å¯ç”¨ï¼‰
2. vLLMï¼ˆå¦‚æœå¯ç”¨ä¸”å¯ç”¨ï¼‰
3. Transformersï¼ˆå¦‚æœå¯ç”¨ä¸”å¯ç”¨ï¼‰
4. äº‘ç«¯APIï¼ˆé»˜è®¤å¤‡é€‰ï¼‰

### è´¨é‡æ§åˆ¶ç³»ç»Ÿ

#### å¢å¼ºè´¨é‡æ£€æŸ¥
```bash
# å¯ç”¨å¢å¼ºè´¨é‡æ£€æŸ¥
python run_pipeline.py \
    --mode quality_control \
    --input_path data/qa_results/results_343.json \
    --quality_threshold 0.8
```

**è´¨é‡æ£€æŸ¥ç»´åº¦**ï¼š
- **æ¨ç†æœ‰æ•ˆæ€§**ï¼šæ£€æŸ¥æ¨ç†é€»è¾‘æ˜¯å¦åˆç†
- **é—®é¢˜æ¸…æ™°åº¦**ï¼šè¯„ä¼°é—®é¢˜è¡¨è¿°æ˜¯å¦æ¸…æ™°
- **ç­”æ¡ˆæ­£ç¡®æ€§**ï¼šéªŒè¯ç­”æ¡ˆçš„å‡†ç¡®æ€§
- **å›¾ç‰‡ä¾èµ–æ€§**ï¼šæ£€æŸ¥æ˜¯å¦æ­£ç¡®ä¾èµ–å›¾ç‰‡å†…å®¹
- **é¢†åŸŸç›¸å…³æ€§**ï¼šéªŒè¯å†…å®¹æ˜¯å¦ç¬¦åˆä¸“ä¸šé¢†åŸŸè¦æ±‚

### æ•°æ®æ”¹å†™å¢å¼º

#### åŸºç¡€æ”¹å†™
```bash
# åŸºç¡€æ”¹å†™å¢å¼º
python model_rewrite/data_generation.py \
    --data-path data/qa_results/original.json \
    --output-path data/rewritten/enhanced.json \
    --template-type basic
```

#### ä¸“ä¸šå¢å¼º
```bash
# ä¸“ä¸šé¢†åŸŸå¢å¼º
python model_rewrite/data_generation.py \
    --data-path data/qa_results/original.json \
    --output-path data/rewritten/professional.json \
    --template-type professional \
    --domain semiconductor
```

#### è´¨é‡æ ‡æ³¨
```bash
# è´¨é‡æ ‡æ³¨å’Œè¯„ä¼°
python model_rewrite/data_label.py \
    --data-path data/rewritten/enhanced.json \
    --output-path data/quality_checked/labeled.json
```

## ğŸ“Š è¾“å‡ºæ ¼å¼

### å¬å›é˜¶æ®µè¾“å‡º
```json
{
  "content": "æ¨¡å‹è¿”å›çš„åŸå§‹å†…å®¹...",
  "image_path": "/path/to/image.png",
  "metadata": {
    "page": 1,
    "confidence": 0.95,
    "processing_time": 2.3
  }
}
```

### æ¸…ç†åè¾“å‡º
```json
{
  "imageDescription": "å›¾ç‰‡æè¿°å†…å®¹...",
  "analysisResults": "åˆ†æç»“æœ...",
  "relatedKnowledge": "ç›¸å…³çŸ¥è¯†...",
  "image_path": "./data/images/sample.png",
  "cleaned_at": "2024-12-20T10:30:00"
}
```

### æœ€ç»ˆQAè¾“å‡º
```json
{
  "metadata": {
    "system_name": "æ™ºèƒ½æ–‡æœ¬QAç”Ÿæˆç³»ç»Ÿ - æ•´åˆç‰ˆ",
    "version": "3.0.0",
    "domain": "semiconductor",
    "generation_time": "20241220_103000",
    "total_qa_pairs": 150,
    "quality_pass_rate": 0.85,
    "rewrite_enhanced": true
  },
  "qa_pairs": [
    {
      "question": "ä»€ä¹ˆæ˜¯IGZOææ–™çš„ä¸»è¦ä¼˜åŠ¿ï¼Ÿ",
      "answer": "IGZOææ–™å…·æœ‰é«˜è¿ç§»ç‡ã€ä½åŠŸè€—å’Œè‰¯å¥½çš„å‡åŒ€æ€§...",
      "choices": ["é€‰é¡¹A", "é€‰é¡¹B", "é€‰é¡¹C", "é€‰é¡¹D"],
      "reasoning": "åŸºäºIGZOææ–™çš„ç‰©ç†ç‰¹æ€§åˆ†æ...",
      "context": "IGZOæ˜¯é“Ÿé•“é”Œæ°§åŒ–ç‰©çš„ç¼©å†™...",
      "quality_score": 0.85,
      "domain": "semiconductor",
      "source_file": "igzo_research.pdf",
      "question_type": "factual",
      "difficulty": "intermediate",
      "is_rewritten": false,
      "original_version": null
    }
  ],
  "pipeline_stats": {
    "total_duration": 1200.5,
    "stages_completed": [
      "text_retrieval", 
      "data_cleaning", 
      "qa_generation", 
      "quality_control", 
      "data_rewriting",
      "final_processing"
    ]
  }
}
```

### æ”¹å†™å¢å¼ºè¾“å‡º
```json
{
  "original_qa": {
    "question": "ä»€ä¹ˆæ˜¯IGZOï¼Ÿ",
    "answer": "IGZOæ˜¯ä¸€ç§ææ–™"
  },
  "rewritten_qa": {
    "question": "è¯·è§£é‡ŠIGZOææ–™çš„åŸºæœ¬æ¦‚å¿µåŠå…¶åœ¨æ˜¾ç¤ºæŠ€æœ¯ä¸­çš„é‡è¦æ€§",
    "answer": "IGZOï¼ˆé“Ÿé•“é”Œæ°§åŒ–ç‰©ï¼‰æ˜¯ä¸€ç§æ–°å‹çš„æ°§åŒ–ç‰©åŠå¯¼ä½“ææ–™ï¼Œå…·æœ‰é«˜è½½æµå­è¿ç§»ç‡ã€è‰¯å¥½çš„å‡åŒ€æ€§å’Œé€æ˜æ€§ç­‰ç‰¹ç‚¹..."
  },
  "rewrite_metadata": {
    "template_type": "professional",
    "improvement_score": 0.92,
    "rewrite_time": "2024-12-20T10:35:00"
  }
}
```

## ğŸ”§ é«˜çº§åŠŸèƒ½

### 1. æ‰¹é‡å¤„ç†è„šæœ¬

åˆ›å»ºè‡ªå®šä¹‰æ‰¹é‡å¤„ç†è„šæœ¬ï¼š
```bash
#!/bin/bash
# batch_process_domains.sh

DOMAINS=("semiconductor" "optics" "materials")
INPUT_BASE="data/pdfs"

for domain in "${DOMAINS[@]}"; do
    echo "Processing domain: $domain"
    python run_pipeline.py \
        --mode full_pipeline \
        --input_path "$INPUT_BASE/$domain" \
        --domain "$domain" \
        --quality_threshold 0.7 \
        --batch_size 50 \
        --enable_rewriting
done
```

### 2. è‡ªå®šä¹‰Promptå¼€å‘

åœ¨ `TextGeneration/prompts_conf.py` ä¸­æ·»åŠ è‡ªå®šä¹‰promptï¼š
```python
# æ·»åŠ æ–°çš„ä¸“ä¸šé¢†åŸŸprompt
user_prompts[999] = """
ä½ æ˜¯ä¸€ä¸ª{domain}é¢†åŸŸçš„ä¸“å®¶ï¼Œè¯·åŸºäºä»¥ä¸‹å†…å®¹ç”Ÿæˆé«˜è´¨é‡çš„é—®ç­”å¯¹ï¼š

å†…å®¹ï¼š{content}

è¦æ±‚ï¼š
1. ç”Ÿæˆ3-5ä¸ªä¸åŒéš¾åº¦çš„é—®é¢˜
2. æ¯ä¸ªé—®é¢˜éƒ½è¦æœ‰è¯¦ç»†çš„æ¨ç†è¿‡ç¨‹
3. ç¡®ä¿ç­”æ¡ˆå‡†ç¡®ä¸”ä¸“ä¸š
4. å¦‚æœæœ‰å›¾ç‰‡ï¼Œè¦å……åˆ†åˆ©ç”¨å›¾ç‰‡ä¿¡æ¯

è¯·æŒ‰ç…§ä»¥ä¸‹JSONæ ¼å¼è¾“å‡ºï¼š
{{
  "qa_pairs": [
    {{
      "question": "é—®é¢˜å†…å®¹",
      "answer": "ç­”æ¡ˆå†…å®¹", 
      "reasoning": "æ¨ç†è¿‡ç¨‹",
      "difficulty": "easy/medium/hard",
      "question_type": "factual/reasoning/application"
    }}
  ]
}}
"""
```

### 3. è‡ªå®šä¹‰æ”¹å†™æ¨¡æ¿

åœ¨ `model_rewrite/rewrite_templates.py` ä¸­æ·»åŠ æ–°æ¨¡æ¿ï¼š
```python
# ä¸“ä¸šé¢†åŸŸæ”¹å†™æ¨¡æ¿
PROFESSIONAL_TEMPLATES = {
    "semiconductor": {
        "question_enhancement": """
        è¯·å°†ä»¥ä¸‹é—®é¢˜æ”¹å†™ä¸ºæ›´ä¸“ä¸šçš„åŠå¯¼ä½“é¢†åŸŸé—®é¢˜ï¼š
        åŸé—®é¢˜ï¼š{original_question}
        
        è¦æ±‚ï¼š
        1. ä½¿ç”¨ä¸“ä¸šæœ¯è¯­
        2. å¢åŠ æŠ€æœ¯æ·±åº¦
        3. ä¿æŒåŸæ„ä¸å˜
        """,
        "answer_enhancement": """
        è¯·å°†ä»¥ä¸‹ç­”æ¡ˆæ”¹å†™ä¸ºæ›´ä¸“ä¸šè¯¦ç»†çš„å›ç­”ï¼š
        åŸç­”æ¡ˆï¼š{original_answer}
        
        è¦æ±‚ï¼š
        1. å¢åŠ æŠ€æœ¯ç»†èŠ‚
        2. ä½¿ç”¨å‡†ç¡®çš„ä¸“ä¸šæœ¯è¯­
        3. æä¾›æ›´æ·±å…¥çš„è§£é‡Š
        """
    }
}
```

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æœ¬åœ°æ¨¡å‹è¿æ¥å¤±è´¥
```bash
# æ£€æŸ¥OllamaæœåŠ¡çŠ¶æ€
ollama list

# é‡å¯OllamaæœåŠ¡
pkill ollama
ollama serve

# æ£€æŸ¥æ¨¡å‹æ˜¯å¦å·²ä¸‹è½½
ollama pull qwen:7b
```

#### 2. å†…å­˜ä¸è¶³
```bash
# å‡å°‘æ‰¹å¤„ç†å¤§å°
python run_pipeline.py --batch_size 20

# å¯ç”¨å†…å­˜ä¼˜åŒ–
export PYTORCH_CUDA_ALLOC_CONF=max_split_size_mb:512
```

#### 3. APIè°ƒç”¨å¤±è´¥
```bash
# æ£€æŸ¥ç½‘ç»œè¿æ¥
curl -I http://your-api-endpoint/v1

# éªŒè¯APIå¯†é’¥
python -c "
import json
with open('config.json') as f:
    config = json.load(f)
print('API Key:', config['api']['api_key'][:10] + '...')
"
```

#### 4. å¤šæ¨¡æ€å¤„ç†é”™è¯¯
```bash
# æ£€æŸ¥å›¾åƒå¤„ç†ä¾èµ–
pip install PyMuPDF Pillow opencv-python

# æ£€æŸ¥PDFæ–‡ä»¶å®Œæ•´æ€§
python -c "
import fitz
doc = fitz.open('your_file.pdf')
print(f'Pages: {len(doc)}')
doc.close()
"
```

#### 5. æ•°æ®æ”¹å†™å¤±è´¥
```bash
# æ£€æŸ¥æ”¹å†™æ¨¡å—ä¾èµ–
pip install textstat wordcloud

# éªŒè¯æ•°æ®æ ¼å¼
python -c "
import json
with open('data/qa_results/sample.json') as f:
    data = json.load(f)
print('Data keys:', list(data.keys()))
"
```

## ğŸ“ˆ ç³»ç»Ÿæ¶æ„

### æ•°æ®æµç¨‹å›¾
```
PDFæ–‡æ¡£ â†’ æ–‡æœ¬å¬å› â†’ æ•°æ®æ¸…ç† â†’ QAç”Ÿæˆ â†’ è´¨é‡æ§åˆ¶ â†’ æ•°æ®æ”¹å†™ â†’ æœ€ç»ˆè¾“å‡º
    â†“         â†“         â†“        â†“        â†“         â†“         â†“
  å›¾åƒæå–   ç»“æ„åŒ–    æ ¼å¼ç»Ÿä¸€   å¤šæ¨¡æ€    è´¨é‡è¯„åˆ†   å†…å®¹å¢å¼º   æŠ¥å‘Šç”Ÿæˆ
             æ•°æ®      JSON     é—®ç­”å¯¹    æ”¹è¿›å»ºè®®   å¤šæ ·åŒ–     ç»Ÿè®¡åˆ†æ
```

### æ¨¡å—äº¤äº’
```
run_pipeline.py (ä¸»æ§åˆ¶å™¨)
    â”œâ”€â”€ TextQA/ (QAå¤„ç†)
    â”œâ”€â”€ TextGeneration/ (æ–‡æœ¬ç”Ÿæˆ)  
    â”œâ”€â”€ LocalModels/ (æœ¬åœ°æ¨¡å‹)
    â”œâ”€â”€ MultiModal/ (å¤šæ¨¡æ€)
    â”œâ”€â”€ model_rewrite/ (æ•°æ®æ”¹å†™)
    â””â”€â”€ å„é¢†åŸŸæ¨¡å—/ (Doubao, Qwen, etc.)
```

## ğŸš€ æ•´åˆå®Œæˆç¡®è®¤

### âœ… å·²æ•´åˆåŠŸèƒ½
- [x] **æ–‡æœ¬å¬å›ä¸æ£€ç´¢** - ä»PDFæ–‡æ¡£æ™ºèƒ½æå–ç›¸å…³å†…å®¹
- [x] **æ•°æ®æ¸…ç†ä¸é¢„å¤„ç†** - æ­£åˆ™è¡¨è¾¾å¼å’ŒAIæ¸…ç†æŠ€æœ¯
- [x] **æ™ºèƒ½QAç”Ÿæˆ** - åŸºäº36+ä¸“ä¸šPromptæ¨¡æ¿ç”Ÿæˆé«˜è´¨é‡é—®ç­”
- [x] **å¢å¼ºè´¨é‡æ§åˆ¶** - å¤šç»´åº¦è´¨é‡æ£€æŸ¥å’Œè‡ªåŠ¨æ”¹è¿›
- [x] **å¤šæ¨¡æ€å¤„ç†** - PDFå›¾æ–‡ç»“åˆï¼Œæ”¯æŒå›¾åƒåˆ†æé—®ç­”
- [x] **æœ¬åœ°æ¨¡å‹æ”¯æŒ** - Ollamaã€vLLMã€Transformersé›†æˆ
- [x] **ä¸“ä¸šé¢†åŸŸå®šåˆ¶** - åŠå¯¼ä½“ã€å…‰å­¦ã€ææ–™ç§‘å­¦ç­‰é¢†åŸŸç‰¹åŒ–
- [x] **æ•°æ®æ”¹å†™å¢å¼º** - æ™ºèƒ½æ”¹å†™æå‡å†…å®¹è´¨é‡å’Œå¤šæ ·æ€§
- [x] **é«˜æ€§èƒ½å¤„ç†** - å¼‚æ­¥æ‰¹å¤„ç†ã€å¤šè¿›ç¨‹æ¶æ„ã€å†…å­˜ä¼˜åŒ–
- [x] **å®Œæ•´é…ç½®ç³»ç»Ÿ** - ç»Ÿä¸€é…ç½®æ–‡ä»¶æ”¯æŒæ‰€æœ‰åŠŸèƒ½
- [x] **ç»Ÿä¸€æµæ°´çº¿** - ä¸€é”®è¿è¡Œå®Œæ•´å¤„ç†æµç¨‹

### ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿
1. **åŠŸèƒ½å®Œæ•´æ€§** - æ¶µç›–ä»åŸå§‹PDFåˆ°æœ€ç»ˆQAå¯¹çš„å®Œæ•´æµç¨‹ï¼ŒåŒ…æ‹¬æ•°æ®æ”¹å†™å¢å¼º
2. **æŠ€æœ¯å…ˆè¿›æ€§** - æ•´åˆæœ€æ–°çš„AIæŠ€æœ¯ã€æœ¬åœ°æ¨¡å‹æ”¯æŒå’Œæ•°æ®å¢å¼ºæŠ€æœ¯
3. **ä¸“ä¸šé¢†åŸŸæ·±åº¦** - é’ˆå¯¹åŠå¯¼ä½“ã€å…‰å­¦ç­‰ä¸“ä¸šé¢†åŸŸæ·±åº¦ä¼˜åŒ–
4. **éƒ¨ç½²çµæ´»æ€§** - æ”¯æŒäº‘ç«¯ã€æœ¬åœ°ã€æ··åˆéƒ¨ç½²æ–¹æ¡ˆ
5. **è´¨é‡ä¿è¯** - å¤šå±‚æ¬¡è´¨é‡æ§åˆ¶ç¡®ä¿è¾“å‡ºè´¨é‡
6. **æ•°æ®å¢å¼º** - æ™ºèƒ½æ”¹å†™æŠ€æœ¯æå‡æ•°æ®è´¨é‡å’Œå¤šæ ·æ€§
7. **æ˜“ç”¨æ€§** - ä¸€é”®è¿è¡Œï¼Œé…ç½®ç®€å•ï¼Œæ–‡æ¡£å®Œå–„

### ğŸ”„ å®Œæ•´å·¥ä½œæµç¨‹
1. **æ–‡æ¡£è¾“å…¥** â†’ PDFæ–‡ä»¶æˆ–æ–‡æœ¬æ–‡ä»¶
2. **æ–‡æœ¬å¬å›** â†’ æ™ºèƒ½æå–ç›¸å…³å†…å®¹
3. **æ•°æ®æ¸…ç†** â†’ æ ¼å¼åŒ–å’Œæ ‡å‡†åŒ–å¤„ç†
4. **QAç”Ÿæˆ** â†’ åŸºäºä¸“ä¸šæ¨¡æ¿ç”Ÿæˆé—®ç­”å¯¹
5. **è´¨é‡æ§åˆ¶** â†’ å¤šç»´åº¦è´¨é‡æ£€æŸ¥å’Œè¯„åˆ†
6. **æ•°æ®æ”¹å†™** â†’ æ™ºèƒ½æ”¹å†™å¢å¼ºå†…å®¹è´¨é‡
7. **æœ€ç»ˆè¾“å‡º** â†’ ç”Ÿæˆå®Œæ•´çš„QAæ•°æ®é›†å’ŒæŠ¥å‘Š

**è®©AIåŠ©åŠ›ä¸“ä¸šçŸ¥è¯†çš„æ™ºèƒ½é—®ç­”ç”Ÿæˆï¼Œç°åœ¨æ”¯æŒæ•°æ®æ”¹å†™å¢å¼ºï¼** ğŸš€

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤Issueæˆ–è”ç³»é¡¹ç›®ç»´æŠ¤è€…ã€‚